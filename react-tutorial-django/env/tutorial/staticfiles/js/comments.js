(function(){var e=new Showdown.converter,t=React.createClass({displayName:"Comment",render:function(){var t=e.makeHtml(this.props.children.toString());return React.DOM.div({className:"comment"},React.DOM.h2({className:"commentAuthor"},this.props.author),React.DOM.span({dangerouslySetInnerHTML:{__html:t}}))}}),n=React.createClass({displayName:"CommentList",render:function(){var e=this.props.data.map(function(e){return t({author:e.author},e.text)});return React.DOM.div({className:"commentList"},e)}}),r=React.createClass({displayName:"CommentForm",handleSubmit:function(){var e=this.refs.author.getDOMNode().value.trim(),t=this.refs.text.getDOMNode().value.trim();return!t||!e?!1:(this.props.onCommentSubmit({author:e,text:t}),this.ref.author.getDOMNode().value="",this.ref.text.getDOMNode().value="",!1)},render:function(){return React.DOM.form({className:"commentForm",onSubmit:this.handleSubmit},React.DOM.input({type:"text",ref:"author",placeholder:"Your name"}),React.DOM.input({type:"text",ref:"text",placeholder:"Say something..."}),React.DOM.input({type:"submit",value:"Post"}))}}),i=React.createClass({displayName:"CommentBox",loadCommentsFromServer:function(){$.ajax({url:this.props.url,dataType:"json",success:function(e){this.setState({data:e})}.bind(this),error:function(e,t,n){console.error(this.props.url,t,n.toString())}.bind(this)})},handleCommentSubmit:function(e){var t=this.state.data,n=t.concat([e]);this.setState({data:n}),$.ajax({url:this.props.url,dataType:"json",type:"POST",data:e,success:function(e){this.setState({data:e})}.bind(this),error:function(e,t,n){console.error(this.props.url,t,n.toString())}.bind(this)})},getInitialState:function(){return{data:[]}},componentWillMount:function(){this.loadCommentsFromServer(),setInterval(this.loadCommentsFromServer,this.props.pollInterval)},render:function(){return React.DOM.div({className:"commentBox"},React.DOM.h1(null,"Comments"),n({data:this.state.data}),r({onCommentSubmit:this.handleCommentSubmit}))}});React.renderComponent(i({url:"/api/v1/comments/",pollInterval:2e3}),document.getElementById("content"))}).call(this);
